version: '3.8'
services:
  api-gateway:
    build: ./api-gateway
    ports:
      - "8100:8000"
    environment:
      - AUTH_SERVICE_URL=http://auth-service:8001
      - ORDER_SERVICE_URL=http://order-service:8002
      - TABLE_SERVICE_URL=http://table-service:8003
      - NOTIFICATION_SERVICE_URL=http://notification-service:8004
      - MENU_SERVICE_URL=http://menu-service:8005
    depends_on:
      - auth-service
      - order-service
      - table-service
      - notification-service
      - menu-service
    networks:
      - restaurant-network

  auth-service:
    build: ./auth-service
    ports:
      - "8101:8001"
    environment:
      - REDIS_URL=redis://redis:6379
    depends_on:
      - redis
    networks:
      - restaurant-network

  order-service:
    build: ./order-service
    ports:
      - "8102:8002"
    environment:
      - REDIS_URL=redis://redis:6379
    depends_on:
      - redis
    networks:
      - restaurant-network
  table-service:
    build: ./table-service
    ports:
      - "8103:8003"
    environment:
      - REDIS_URL=redis://redis:6379
    depends_on:
      - redis
    networks:
      - restaurant-network
  notification-service:
    build: ./notification-service
    ports:
      - "8104:8004"
    environment:
      - REDIS_URL=redis://redis:6379
    depends_on:
      - redis
    networks:
      - restaurant-network
  menu-service:
    build: ./menu-service
    ports:
      - "8105:8005"
    networks:
      - restaurant-network
  redis:
    image: redis:7-alpine
    ports:
      - "6381:6379"
    networks:
      - restaurant-network

networks:
  restaurant-network:
    driver: bridge